!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jsongin=e():n.jsongin=e()}("undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var n={160:n=>{function e(n,e){e||(e={});var t={},r=null,a=null,i={UserEmail:null,Password:null};class s extends Error{constructor(n){super(`Network error: [${n.status}] ${n.statusText}`),this.name="NetworkError",this.Response=n}}class o extends Error{constructor(n){super(n.error),this.name="ApiError",this.ApiResponse=n}}async function u(t,c,l=null){l||(l={});try{var f=n+t,d="ExchangeApi",w={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)};if(r&&r.session_token)w.headers.Authorization=`Bearer ${r.session_token}`;else if("undefined"!=typeof window&&a){var p=null;a.session&&(p=await a.session.getToken()),p&&(w.headers.Authorization=`Bearer ${p}`)}r&&r.User?d+=` as (${r.User.user_name})`:d+=" as (anonymous)",e.log_requests&&console.log(`${d} --\x3e> Server [${t}]`,c);var y=await fetch(f,w);if(!y)throw new Error("Received an empty response from fetch.");if(!y.ok){if(511===y.status){if(console.log("Session token has expired, re-authenticating."),!(r=await u("/Session/Signin",{email_address:i.UserEmail,password:i.Password},null)))throw new Error("Failed to re-authenticate.");return await u(t,c,l)}throw new s(y)}var _=await y.json();if(e.log_responses&&console.log(`${d} <<-- Server [${t}]`,_),_.error)throw new o(_);return e.GlobalCallback&&"function"==typeof e.GlobalCallback&&await e.GlobalCallback(null,_.result),l.Callback&&"function"==typeof l.Callback&&await l.Callback(null,_.result),_.result}catch(n){var g=null,m=!1;if(n instanceof s)g=new Error(`In command [${t}]; ${n.message}`);else if(n instanceof o)g=new Error(`In command [${t}]; ${n.message}`);else{var h=`In command [${t}]; ${n.message}`;n.cause&&n.cause.code&&(h+=` [${n.cause.code}]`),g=new Error(h)}if(e.GlobalCallback&&"function"==typeof e.GlobalCallback&&(await e.GlobalCallback(g.message,null),m=!0),l.Callback&&"function"==typeof l.Callback&&(await l.Callback(g.message,null),m=!0),e.throw_handled_errors||!m)throw g}}return{SetCache:function(n,e,r){var a={Data:e,expires:Date.now()+r};t[n]=a},GetCache:function(n){var e=t[n];return e.expires<=Date.now()?(delete t[n],null):e.Data},ClearCache:function(n){n?delete t[n]:t={}},Authenticate:async function(n,e,t=!0){return(r=await u("/Session/Signin",{email_address:n,password:e},null))?(t&&(i.UserEmail=n,i.Password=e),r.User):null},BrowserClerk:async function(n){return a=n,(r={}).User=await u("/User",{},null),r.User?r.User:null},Server:{GetServerInfo:async function(n=null){return await u("/Session/ServerInfo",{},n)},GetServerError:async function(n=null){return await u("/Session/ServerError",{},n)},GetAssetType:async function(n,e=null){return await u("/AssetTypeSpecifications",{asset_type:n},e)},GetUser:async function(n=null){return await u("/User",{},n)},LookupUser:async function(n,e=null){return await u("/User/Lookup",{email_address:n},e)}},Accounts:{List:async function(n=null){return await u("/Accounts",{},n)},Get:async function(n,e=null){return await u("/Account",{account_id:n},e)},Create:async function(n=null){return await u("/Account/Create",{},n)},Destroy:async function(n,e=null){return await u("/Account/Destroy",{account_id:n},e)},Rename:async function(n,e,t=null){return await u("/Account/Rename",{account_id:n,account_name:e},t)},GetAssets:async function(n,e=null){return await u("/Account/Assets",{account_id:n},e)},GetAssetSummary:async function(n,e,t=null){return await u("/Account/AssetSummary",{account_id:n,ResolveFields:e},t)},GetAudits:async function(n,e=null){return await u("/Account/Audits",{account_id:n},e)},Funding:async function(n,e,t,r=null){var a=JSON.parse(JSON.stringify(t));return a.account_id=n,a.funding_action=e,await u("/Account/Funding",a,r)},TestDeposit:async function(n,e,t=null){return await u("/Account/Funding",{funding_action:"deposit.direct",account_id:n,amount_cents:e},t)},TestWithdraw:async function(n,e,t=null){return await u("/Account/Funding",{funding_action:"withdraw.direct",account_id:n,amount_cents:e},t)}},Permissions:{List:async function(n,e=null){return await u("/Permissions",{account_id:n},e)},Set:async function(n,e,t,r=null){return await u("/SetPermission",{account_id:n,user_id:e,permission:t},r)},Unset:async function(n,e,t,r=null){return await u("/UnsetPermission",{account_id:n,user_id:e,permission:t},r)}},Offerings:{List:async function(n,e=null){return await u("/Offerings",{account_id:n},e)},Get:async function(n,e=null){return await u("/Offering",{offering_id:n},e)},Create:async function(n,e,t=null){return await u("/Offering/Create",{account_id:n,asset_type:e},t)},Destroy:async function(n,e=null){return await u("/Offering/Delete",{offering_id:n},e)},Update:async function(n,e,t=null){return await u("/Offering/Save",{offering_id:n,offering_name:e.offering_name,description:e.description,asset_info:e.asset_info,supplier_fee_rate:e.supplier_fee_rate},t)},Activate:async function(n,e=null){return await u("/Offering/Activate",{offering_id:n},e)},Pause:async function(n,e=null){return await u("/Offering/Pause",{offering_id:n},e)}},PublicOfferings:{List:async function(n=null){return await u("/PublicOfferings",{},n)},Get:async function(n,e=null){return await u("/PublicOffering",{offering_id:n},e)},GetMarket:async function(n,e,t=null){return await u("/PublicOffering/Market",{offering_id:n,price_format:e},t)}},Orders:{List:async function(n,e,t=null){return await u("/Orders",{account_id:n,include_closed:e},t)},Get:async function(n,e=null){return await u("/Order",{order_id:n},e)},Create:async function(n,e,t,a=null){if(!r||!r.User)throw new Error("You must call Authenticate() or Connect() before using the Exchange Client.");return await u("/Order/Create",{user_id:r.User.user_id,account_id:n,offering_id:e,order_type:t.order_type,unit_count:t.unit_count,unit_price:t.unit_price,expiration:t.expiration},a)},Close:async function(n,e=null){return await u("/Order/Close",{order_id:n},e)},GetTransactions:async function(n,e=null){return await u("/Order/Transactions",{order_id:n},e)}}}}n.exports=e,"undefined"!=typeof window&&(void 0===window.SpiritEx&&(window.SpiritEx={}),window.SpiritEx.NewExchangeClient=e)}},e={};return function t(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return n[r](i,i.exports,t),i.exports}(160)})()));